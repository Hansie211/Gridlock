import{a as R,M as Q,N as H,h as G,k as L,m as y,d as I,e as P,j as D,q as F,t as K,D as k,_ as $,F as d,O as m,K as p,P as E,r as g,E as V,L as c,Q as b,R as _,G as S,S as W,I as r,T as v,H as f,U as C,V as M,W as j,X as z,Y as T,Z as B}from"./index.0c688e54.js";const U='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>';var Y=R({name:"QSpinnerDots",props:Q,setup(e){const{cSize:t,classes:l}=H(e);return()=>G("svg",{class:l.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:U})}}),A=R({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:l}}=D(),s=L(F,y);if(s===y)return console.error("QPage needs to be a deep child of QLayout"),y;if(L(K,y)===y)return console.error("QPage needs to be child of QPageContainer"),y;const u=I(()=>{const o=(s.header.space===!0?s.header.size:0)+(s.footer.space===!0?s.footer.size:0);if(typeof e.styleFn=="function"){const a=s.isContainer.value===!0?s.containerHeight.value:l.screen.height;return e.styleFn(o,a)}return{minHeight:s.isContainer.value===!0?s.containerHeight.value-o+"px":l.screen.height===0?o!==0?`calc(100vh - ${o}px)`:"100vh":l.screen.height-o+"px"}}),n=I(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>G("main",{class:n.value,style:u.value},P(t.default))}});const X=k({name:"GameCell",emits:["click"],props:{originalValue:{type:Number,required:!0},userValue:{type:Number,required:!0},isWrong:{type:Boolean,default:!0},isSelected:{type:Boolean,default:!1},isRowStart:{type:Boolean,default:!1},isRowEnd:{type:Boolean,default:!1},isColStart:{type:Boolean,default:!1},isColEnd:{type:Boolean,default:!1}},computed:{isConstant(){return this.originalValue!==0},displayValue(){const e=this.originalValue>0?this.originalValue:this.userValue;return e>0?e.toString():""}}});function Z(e,t,l,s,i,u){return d(),m("div",{class:E(["cell",{"row-start":e.isRowStart,"row-end":e.isRowEnd,"col-start":e.isColStart,"col-end":e.isColEnd,constant:e.isConstant,selected:e.isSelected,wrong:e.isWrong}]),onClick:t[0]||(t[0]=n=>e.$emit("click"))},p(e.displayValue),3)}var J=$(X,[["render",Z],["__scopeId","data-v-68f95463"]]);const x=k({name:"GameBoard",components:{GameCell:J},emits:["solved"],props:{board:{type:Object,required:!0},solution:{type:Object,required:!0}},setup(e){const t=g([...e.solution.skeleton]),l=g(Array.from({length:e.board.cellcount},()=>[]));return{userValues:t,userNotes:l,userMoveMemories:[]}},mounted(){this.resetLevel()},data(){return{selectedCellIndex:void 0}},computed:{selectedCellRow(){if(this.selectedCellIndex!==void 0)return Math.floor(this.selectedCellIndex/this.board.size)+1},selectedCellCol(){if(this.selectedCellIndex!==void 0)return this.selectedCellIndex%this.board.size+1},isSolved(){for(let e=0;e<this.board.cellcount;e++){const t=this.solution.solution[e];if(this.userValues[e]!==t)return!1}return!0}},methods:{getCellIndex(e,t){return(t-1)*this.board.size+(e-1)},getSkeletonValue(e,t){const l=this.getCellIndex(e,t);return this.solution.skeleton[l]},getUserValue(e,t){const l=this.getCellIndex(e,t);return this.userValues[l]},getIsWrong(e,t){const l=this.getCellIndex(e,t);if(this.solution.skeleton[l]!==0||this.userValues[l]===0)return!1;const s=this.userValues[l],i=this.solution.solution[l];return s!==i},onClickCell(e,t){if(this.isSolved)return;const l=this.getCellIndex(e,t);if(this.solution.skeleton[l]!==0){this.selectedCellIndex=void 0;return}if(l===this.selectedCellIndex){this.selectedCellIndex=void 0;return}this.selectedCellIndex=l},setSelectedCellValue(e,t){if(this.isSolved||this.selectedCellIndex===void 0)return;const l={cellIndex:this.selectedCellIndex,oldValue:this.userValues[this.selectedCellIndex]};this.userMoveMemories.push(l),this.userValues[this.selectedCellIndex]=e!==this.userValues[this.selectedCellIndex]?e:0},undoLastUserMove(){if(this.isSolved)return;const e=this.userMoveMemories.pop();if(e===void 0)return;const t=e.cellIndex,l=e.oldValue;this.userValues[t]=l,this.selectedCellIndex=void 0},resetLevel(){this.userValues=this.solution.skeleton.map((e,t)=>{const l=Math.floor(t/this.board.size)+1,s=t%this.board.size+1,i=this.getCellSegmentFlags(s,l);return i.isRowStart&&i.isRowEnd&&i.isColStart&&i.isColEnd?1:e}),this.userMoveMemories=[]},getCellSegmentFlags(e,t){const l=this.board.rows[t-1],s=this.board.columns[e-1];let i=!1,u=!1,n=!1,o=!1,a=0;for(const h of l)e-1===a&&(i=!0),a+=h-1,e-1===a&&(u=!0),a+=1;a=0;for(const h of s)t-1===a&&(n=!0),a+=h-1,t-1===a&&(o=!0),a+=1;return{isRowStart:i,isRowEnd:u,isColStart:n,isColEnd:o}}},watch:{isSolved(e,t){e&&!t&&(this.$emit("solved"),this.selectedCellIndex=void 0)}}}),ee={class:"flex column"},te={class:"game-board"};function le(e,t,l,s,i,u){const n=V("game-cell");return d(),m("div",ee,[c("span",null,p(e.isSolved?"Solved \u2705":" "),1),c("div",te,[(d(!0),m(b,null,_(e.board.size,o=>(d(),m("div",{key:o,class:"board-row"},[(d(!0),m(b,null,_(e.board.size,a=>(d(),S(n,W({key:a,originalValue:e.getSkeletonValue(a,o),userValue:e.getUserValue(a,o)},{ref_for:!0},e.getCellSegmentFlags(a,o),{onClick:()=>e.onClickCell(a,o),isSelected:a===e.selectedCellCol&&o===e.selectedCellRow,isWrong:e.getIsWrong(a,o)}),null,16,["originalValue","userValue","onClick","isSelected","isWrong"]))),128))]))),128))])])}var se=$(x,[["render",le],["__scopeId","data-v-6eeb2ce8"]]);const ne=k({name:"GameKeyboard",props:{size:{type:Number,required:!0}},emits:["number-click","undo-click","menu-click"],setup(e,{emit:t}){return{onNumberClick:s=>{t("number-click",{value:s,notesMode:!1})}}}}),oe={class:"game-keyboard column items-center justify-center q-pa-xs q-gutter-y-sm"},ie={class:"row no-wrap q-gutter-xs justify-center"},re={class:"q-gutter-x-sm justify-center q-ml-sm"};function ae(e,t,l,s,i,u){return d(),m("div",oe,[c("div",ie,[(d(!0),m(b,null,_(e.size,n=>(d(),S(v,{key:n,label:n,onClick:o=>e.onNumberClick(n),flat:"",dense:"",class:"number-btn"},null,8,["label","onClick"]))),128))]),c("div",re,[r(v,{icon:"close",onClick:t[0]||(t[0]=n=>e.onNumberClick(0)),flat:"",dense:"",class:"action-btn"}),r(v,{icon:"undo",flat:"",dense:"",onClick:t[1]||(t[1]=n=>e.$emit("undo-click")),class:"action-btn"}),r(v,{icon:"menu",flat:"",dense:"",onClick:t[2]||(t[2]=n=>e.$emit("menu-click")),class:"action-btn"})])])}var ue=$(ne,[["render",ae],["__scopeId","data-v-db4ad59c"]]);const de=k({name:"GameMenu",props:{level:{type:Number,required:!0},difficulty:{type:Number,required:!0}},emits:["settings-click","new-level-click","retry-level-click","show-completed-click","close"]}),ce={class:"text-h6 text-weight-bold"},me={class:"text-subtitle2 text-grey-7"};function fe(e,t,l,s,i,u){return d(),S(j,{class:"game-menu q-pa-md column items-start justify-center",flat:"",bordered:""},{default:f(()=>[r(C,{class:"q-pb-sm column"},{default:f(()=>[c("div",ce,"Level #"+p(e.level),1),c("div",me,"Difficulty: "+p(e.difficulty),1)]),_:1}),r(M,{spaced:""}),r(C,{class:"full-width q-gutter-sm"},{default:f(()=>[r(v,{label:"Settings",icon:"settings",align:"left",class:"full-width",unelevated:"",rounded:"",onClick:t[0]||(t[0]=n=>e.$emit("settings-click"))}),r(v,{label:"New Level",icon:"play_arrow",align:"left",class:"full-width",unelevated:"",rounded:"",onClick:t[1]||(t[1]=n=>e.$emit("new-level-click"))}),r(v,{label:"Retry Level",icon:"refresh",align:"left",class:"full-width",unelevated:"",rounded:"",onClick:t[2]||(t[2]=n=>e.$emit("retry-level-click"))}),r(v,{label:"Completed Games",icon:"check_circle",align:"left",class:"full-width",unelevated:"",rounded:"",onClick:t[3]||(t[3]=n=>e.$emit("show-completed-click"))})]),_:1}),r(M,{spaced:""}),r(C,{class:"full-width q-gutter-sm",align:"right"},{default:f(()=>[r(v,{label:"Close",unelevated:"",rounded:"",onClick:t[4]||(t[4]=n=>e.$emit("close"))})]),_:1})]),_:1})}var pe=$(de,[["render",fe],["__scopeId","data-v-41b083eb"]]);const ve=()=>!0;function ge(e){const t={};return e.forEach(l=>{t[l]=ve}),t}function q(){const{emit:e,proxy:t}=D(),l=g(null);function s(){l.value.show()}function i(){l.value.hide()}function u(o){e("ok",o),i()}function n(){e("hide")}return Object.assign(t,{show:s,hide:i}),{dialogRef:l,onDialogHide:n,onDialogOK:u,onDialogCancel:i}}const O=["ok","hide"];q.emits=O;q.emitsObject=ge(O);const he=k({name:"DifficultySelectMenu",props:{initial:{type:Number,default:1}},emits:["ok","hide"],setup(){const{dialogRef:e,onDialogHide:t,onDialogOK:l,onDialogCancel:s}=q();return{dialogRef:e,onDialogHide:t,onOKClick:n=>{l(n)},onCancelClick:()=>{s()}}},computed:{options(){return[{value:1,label:"Very Easy",color:"yellow",stars:1},{value:2,label:"Very Easy",color:"yellow",stars:2},{value:3,label:"Very Easy",color:"yellow",stars:3},{value:4,label:"Easy",color:"blue",stars:1},{value:5,label:"Easy",color:"blue",stars:2},{value:6,label:"Easy",color:"blue",stars:3},{value:7,label:"Hard",color:"red",stars:1},{value:8,label:"Hard",color:"red",stars:2},{value:9,label:"Hard",color:"red",stars:3}]}}}),ye={class:"column justify-around"},Ce=["onClick"],be={class:"row justify-center q-mb-xs"};function ke(e,t,l,s,i,u){return d(),S(z,{ref:"dialogRef",onHide:e.onDialogHide},{default:f(()=>[r(j,{class:"q-pa-md column items-center justify-center",style:{width:"400px"}},{default:f(()=>[r(C,{class:"text-center q-pb-sm"},{default:f(()=>[...t[0]||(t[0]=[c("div",{class:"text-h6 text-weight-bold"},"Select Difficulty",-1)])]),_:1}),r(M,{spaced:""}),r(C,{class:"full-width q-gutter-sm"},{default:f(()=>[c("div",ye,[(d(!0),m(b,null,_(e.options,n=>(d(),m("div",{key:n.value,class:E(["row items-center justify-start difficulty-option q-pa-xs q-gutter-x-md",{highlighted:n.value===e.initial}]),onClick:o=>e.onOKClick(n.value)},[c("span",null,p(n.label),1),c("span",be,[(d(!0),m(b,null,_(n.stars,o=>(d(),m("span",{key:o,class:"star",style:T({color:n.color,fontSize:"1.5em"})},"\u2605",4))),128))])],10,Ce))),128))])]),_:1}),r(M,{spaced:""}),r(C,{class:"full-width q-gutter-sm"},{default:f(()=>[r(v,{label:"Cancel",color:"negative",flat:"",rounded:"",class:"full-width",onClick:e.onCancelClick},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onHide"])}var $e=$(he,[["render",ke],["__scopeId","data-v-da6d386a"]]);const _e=k({name:"IndexPage",components:{GameBoard:se,GameKeyboard:ue,GameMenu:pe},setup(){const e=g(null),t=g(!0),l=g(),s=g(),i=g(0);let u;const n=()=>{u&&clearInterval(u),i.value=0,u=setInterval(()=>{i.value+=1},1e3)},o=()=>{u&&clearInterval(u)},a=new Worker("/Gridlock/assets/boardWorker.1e22e016.js",{type:"module"});return a.onmessage=h=>{const w=h.data;if(w.error){console.error("Board generation failed:",w.error);return}l.value=w.board,s.value=w.solution,t.value=!1,n()},{gameBoard:e,isGenerating:t,board:l,solution:s,boardGenerationWorker:a,elapsedSeconds:i,clearTimer:o,resetTimer:n}},mounted(){const e=N(1,1e3),t=N(1,9);this.generateLevel(e,t)},unmounted(){this.clearTimer()},data(){return{seed:0,difficulty:1,menuVisible:!1}},methods:{generateLevel(e,t){this.seed=e,this.difficulty=t,this.isGenerating=!0,this.boardGenerationWorker.postMessage({seed:this.seed,difficulty:this.difficulty})},onUndoClick(){!this.gameBoard||this.gameBoard.undoLastUserMove()},onNumberClick(e){!this.gameBoard||this.gameBoard.setSelectedCellValue(e.value,e.notesMode)},onRetryLevelClick(){if(!this.gameBoard)return;const e=this.gameBoard;B.create({title:"Retry Level",message:"Are you sure you want to retry this level? Your current progress will be lost.",persistent:!0,ok:{label:"Retry",color:"negative",unelevated:!0},cancel:{label:"Cancel",flat:!0}}).onOk(()=>{e.resetLevel(),this.resetTimer(),this.closeMenu()})},async onNewLevelClick(){const e=await new Promise(t=>{var l;B.create({component:$e,componentProps:{initial:(l=this.difficulty)!=null?l:1},persistent:!0}).onOk(s=>t(s))});e&&(this.generateLevel(N(1,1e3),e),this.closeMenu())},closeMenu(){this.menuVisible=!1},onSolved(){this.clearTimer(),B.create({title:"Congratulations!",message:`You solved the level in ${this.elapsedTime}!`,ok:{label:"Ok",color:"primary",unelevated:!0},persistent:!0}).onOk(()=>{this.generateLevel(this.seed+1,this.difficulty)})}},computed:{elapsedTime(){if(this.elapsedSeconds<=0)return"00:00";const e=Math.floor(this.elapsedSeconds/60),t=this.elapsedSeconds%60,l=String(e).padStart(2,"0"),s=String(t).padStart(2,"0");return`${l}:${s}`}}});function N(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(e+(t-e+1)*Math.random())}const Se={key:0,class:"loading-overlay column items-center justify-center"},we={class:"q-mt-md"};function Ve(e,t,l,s,i,u){const n=V("game-board"),o=V("game-keyboard"),a=V("game-menu");return d(),S(A,{class:"column items-center justify-evenly"},{default:f(()=>[e.isGenerating?(d(),m("div",Se,[r(Y,{size:"50px",color:"primary"}),c("div",we,[t[2]||(t[2]=c("p",null,"Generating Board...",-1)),c("p",null,"Level: "+p(e.seed),1),c("p",null,"Difficulty: "+p(e.difficulty),1)])])):(d(),m(b,{key:1},[c("p",null,"Level: "+p(e.seed)+", difficulty "+p(e.difficulty)+", "+p(e.elapsedTime),1),r(n,{ref:"gameBoard",board:e.board,solution:e.solution,onSolved:e.onSolved},null,8,["board","solution","onSolved"]),r(o,{size:e.board.size,onNumberClick:e.onNumberClick,onUndoClick:e.onUndoClick,onMenuClick:t[0]||(t[0]=()=>e.menuVisible=!0)},null,8,["size","onNumberClick","onUndoClick"])],64)),r(z,{modelValue:e.menuVisible,"onUpdate:modelValue":t[1]||(t[1]=h=>e.menuVisible=h),persistent:""},{default:f(()=>[r(a,{level:e.seed,difficulty:e.difficulty,onClose:e.closeMenu,onRetryLevelClick:e.onRetryLevelClick,onNewLevelClick:e.onNewLevelClick},null,8,["level","difficulty","onClose","onRetryLevelClick","onNewLevelClick"])]),_:1},8,["modelValue"])]),_:1})}var Be=$(_e,[["render",Ve]]);export{Be as default};
